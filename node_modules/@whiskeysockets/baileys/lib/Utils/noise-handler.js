'use strict';function a1221_0x6d89(){const _0x3359b9=['pGMeW','fyboN','certification\x20match\x20failed','utf8','trace','hkdf','readUInt8','attrs','recv\x20','fmYNv','recv\x20frame','Boom','sha256','private','PlMsE','writeUint16BE','hQVvx','CertChain','sharedKey','DEvnL','TdyJl','decode','vskwj','Curve','../Defaults','ephemeral','../WABinary','child','writeUint8','12694iTxKWd','wfWUP','pkezt','__esModule','3315330axYhLY','366YtFxDS','./crypto','../../WAProto','5qPExOm','byteLength','slice','pGOvz','zvymD','357447dZNplm','WA_CERT_DETAILS','6427442UnGaZq','length','aesDecryptGCM','10232514YUSaQE','static','SERIAL','set','defineProperty','payload','from','6ehRRbF','decodeBinaryNode','SaFyt','aesEncryptGCM','alloc','public','2570408RrXItr','concat','proto','writeUInt8','BTOlj','2943216vYnZXk','makeNoiseHandler','GCaif','Details','readUInt16BE'];a1221_0x6d89=function(){return _0x3359b9;};return a1221_0x6d89();}const a1221_0x1ed2c8=a1221_0x612f;(function(_0x2d00ad,_0x4549b0){const _0x561cb9=a1221_0x612f,_0x1d76dc=_0x2d00ad();while(!![]){try{const _0x143cbf=-parseInt(_0x561cb9(0x222))/0x1+-parseInt(_0x561cb9(0x215))/0x2*(-parseInt(_0x561cb9(0x21a))/0x3)+-parseInt(_0x561cb9(0x234))/0x4*(-parseInt(_0x561cb9(0x21d))/0x5)+-parseInt(_0x561cb9(0x22e))/0x6*(parseInt(_0x561cb9(0x224))/0x7)+-parseInt(_0x561cb9(0x1f3))/0x8+parseInt(_0x561cb9(0x227))/0x9+-parseInt(_0x561cb9(0x219))/0xa;if(_0x143cbf===_0x4549b0)break;else _0x1d76dc['push'](_0x1d76dc['shift']());}catch(_0x91a2ab){_0x1d76dc['push'](_0x1d76dc['shift']());}}}(a1221_0x6d89,0x8d4ea));function a1221_0x612f(_0xf7a08d,_0x2c4952){const _0x6d89f5=a1221_0x6d89();return a1221_0x612f=function(_0x612f44,_0x6adbce){_0x612f44=_0x612f44-0x1f2;let _0x5b4794=_0x6d89f5[_0x612f44];return _0x5b4794;},a1221_0x612f(_0xf7a08d,_0x2c4952);}Object[a1221_0x1ed2c8(0x22b)](exports,a1221_0x1ed2c8(0x218),{'value':!![]}),exports[a1221_0x1ed2c8(0x1f4)]=void 0x0;const boom_1=require('@hapi/boom'),WAProto_1=require(a1221_0x1ed2c8(0x21c)),Defaults_1=require(a1221_0x1ed2c8(0x210)),WABinary_1=require(a1221_0x1ed2c8(0x212)),crypto_1=require(a1221_0x1ed2c8(0x21b)),generateIV=_0x42ed83=>{const _0x40885c=new ArrayBuffer(0xc);return new DataView(_0x40885c)['setUint32'](0x8,_0x42ed83),new Uint8Array(_0x40885c);},makeNoiseHandler=({keyPair:{private:_0x37e95e,public:_0x5abd8b},NOISE_HEADER:_0x58626b,logger:_0x5ee642,routingInfo:_0x174f26})=>{const _0x8e27b=a1221_0x1ed2c8,_0x53aaee={'BTOlj':function(_0x4f8834,_0x1cdb8f){return _0x4f8834(_0x1cdb8f);},'PlMsE':function(_0x1dd655,_0xddbbf2){return _0x1dd655(_0xddbbf2);},'hQVvx':function(_0x558832,_0x482add){return _0x558832(_0x482add);},'SaFyt':function(_0x1aea1f,_0x42172b){return _0x1aea1f(_0x42172b);},'TdyJl':_0x8e27b(0x1fa),'wfWUP':function(_0x341046,_0x360736){return _0x341046(_0x360736);},'fmYNv':'5|6|0|1|3|2|4','GCaif':function(_0x5d3559,_0x25174e){return _0x5d3559&_0x25174e;},'CsQLb':function(_0x1a04a0,_0x3a7245){return _0x1a04a0>>_0x3a7245;},'pGMeW':function(_0x5cbb5b,_0x44f27e){return _0x5cbb5b&_0x44f27e;},'DONEW':function(_0x456e48,_0xff18e7){return _0x456e48+_0xff18e7;},'pkezt':function(_0x9de585,_0x25448d){return _0x9de585>=_0x25448d;},'vskwj':function(_0x2b5750,_0x4303c8){return _0x2b5750|_0x4303c8;},'MqtEy':function(_0x40a3fa,_0xe4aca3){return _0x40a3fa<<_0xe4aca3;},'pGOvz':function(_0x3a2737){return _0x3a2737();},'cVhMI':function(_0x3cd85f,_0x218458){return _0x3cd85f>=_0x218458;},'fyboN':function(_0x5d07ea,_0x199d21){return _0x5d07ea+_0x199d21;},'DEvnL':function(_0x3a0193,_0x2a64f6){return _0x3a0193===_0x2a64f6;},'thtdP':_0x8e27b(0x202),'zvymD':function(_0x532e69,_0x479da9){return _0x532e69(_0x479da9);}};_0x5ee642=_0x5ee642[_0x8e27b(0x213)]({'class':'ns'});const _0x2f7a59=_0x4aed25=>{const _0x521ee2=_0x8e27b;!_0x5b4283&&(_0x86c847=(0x0,crypto_1[_0x521ee2(0x204)])(Buffer[_0x521ee2(0x235)]([_0x86c847,_0x4aed25])));},_0x48591a=_0x5191dc=>{const _0x28d202=_0x8e27b,_0x6580f6=(0x0,crypto_1[_0x28d202(0x231)])(_0x5191dc,_0x5bb315,_0x53aaee['BTOlj'](generateIV,_0xba7610),_0x86c847);return _0xba7610+=0x1,_0x53aaee[_0x28d202(0x1f2)](_0x2f7a59,_0x6580f6),_0x6580f6;},_0x507a3f=_0x32ea35=>{const _0xa3ea4f=_0x8e27b,_0x460973=_0x53aaee[_0xa3ea4f(0x206)](generateIV,_0x5b4283?_0x469144:_0xba7610),_0x120ad6=(0x0,crypto_1[_0xa3ea4f(0x226)])(_0x32ea35,_0x31f162,_0x460973,_0x86c847);return _0x5b4283?_0x469144+=0x1:_0xba7610+=0x1,_0x2f7a59(_0x32ea35),_0x120ad6;},_0x161ce8=async _0x322e10=>{const _0x99ad4c=_0x8e27b,_0x4cce25=await(0x0,crypto_1[_0x99ad4c(0x1fd)])(Buffer['from'](_0x322e10),0x40,{'salt':_0x110400,'info':''});return[_0x4cce25['slice'](0x0,0x20),_0x4cce25[_0x99ad4c(0x21f)](0x20)];},_0x1d8cf8=async _0x5cf7ca=>{const [_0x335d12,_0x2e63de]=await _0x53aaee['hQVvx'](_0x161ce8,_0x5cf7ca);_0x110400=_0x335d12,_0x5bb315=_0x2e63de,_0x31f162=_0x2e63de,_0x469144=0x0,_0xba7610=0x0;},_0x1631e5=async()=>{const _0x1bca0d=_0x8e27b,[_0x3bd43f,_0xbfd8b7]=await _0x53aaee[_0x1bca0d(0x230)](_0x161ce8,new Uint8Array(0x0));_0x5bb315=_0x3bd43f,_0x31f162=_0xbfd8b7,_0x86c847=Buffer[_0x1bca0d(0x22d)]([]),_0x469144=0x0,_0xba7610=0x0,_0x5b4283=!![];},_0x232551=Buffer['from'](Defaults_1['NOISE_MODE']);let _0x86c847=_0x232551['byteLength']===0x20?_0x232551:(0x0,crypto_1['sha256'])(_0x232551),_0x110400=_0x86c847,_0x5bb315=_0x86c847,_0x31f162=_0x86c847,_0x469144=0x0,_0xba7610=0x0,_0x5b4283=![],_0x39b8cf=![],_0x12bf85=Buffer[_0x8e27b(0x232)](0x0);return _0x2f7a59(_0x58626b),_0x53aaee[_0x8e27b(0x221)](_0x2f7a59,_0x5abd8b),{'encrypt':_0x48591a,'decrypt':_0x507a3f,'authenticate':_0x2f7a59,'mixIntoKey':_0x1d8cf8,'finishInit':_0x1631e5,'processHandshake':async({serverHello:_0x58ccb8},_0x58962b)=>{const _0x548b90=_0x8e27b;_0x53aaee['hQVvx'](_0x2f7a59,_0x58ccb8[_0x548b90(0x211)]),await _0x1d8cf8(crypto_1['Curve'][_0x548b90(0x20a)](_0x37e95e,_0x58ccb8[_0x548b90(0x211)]));const _0x5eec29=_0x53aaee[_0x548b90(0x208)](_0x507a3f,_0x58ccb8[_0x548b90(0x228)]);await _0x53aaee['BTOlj'](_0x1d8cf8,crypto_1[_0x548b90(0x20f)][_0x548b90(0x20a)](_0x37e95e,_0x5eec29));const _0x13272c=_0x507a3f(_0x58ccb8[_0x548b90(0x22c)]),{intermediate:_0x1ef15c}=WAProto_1[_0x548b90(0x236)][_0x548b90(0x209)][_0x548b90(0x20d)](_0x13272c),{issuerSerial:_0x29bbc1}=WAProto_1['proto'][_0x548b90(0x209)]['NoiseCertificate'][_0x548b90(0x1f6)][_0x548b90(0x20d)](_0x1ef15c['details']);if(_0x29bbc1!==Defaults_1[_0x548b90(0x223)][_0x548b90(0x229)])throw new boom_1[(_0x548b90(0x203))](_0x53aaee[_0x548b90(0x20c)],{'statusCode':0x190});const _0x3e1f31=_0x53aaee[_0x548b90(0x1f2)](_0x48591a,_0x58962b[_0x548b90(0x233)]);return await _0x53aaee[_0x548b90(0x1f2)](_0x1d8cf8,crypto_1[_0x548b90(0x20f)][_0x548b90(0x20a)](_0x58962b[_0x548b90(0x205)],_0x58ccb8[_0x548b90(0x211)])),_0x3e1f31;},'encodeFrame':_0x152dfb=>{const _0x6d286a=_0x8e27b;_0x5b4283&&(_0x152dfb=_0x53aaee[_0x6d286a(0x216)](_0x48591a,_0x152dfb));let _0x177b87;if(_0x174f26){const _0x4a4346=_0x53aaee[_0x6d286a(0x201)]['split']('|');let _0x5eac1b=0x0;while(!![]){switch(_0x4a4346[_0x5eac1b++]){case'0':_0x177b87['writeUint8'](0x0,0x2);continue;case'1':_0x177b87[_0x6d286a(0x214)](0x1,0x3);continue;case'2':_0x177b87[_0x6d286a(0x207)](_0x53aaee[_0x6d286a(0x1f5)](_0x174f26['byteLength'],0xffff),0x5);continue;case'3':_0x177b87['writeUint8'](_0x53aaee['CsQLb'](_0x174f26[_0x6d286a(0x21e)],0x10),0x4);continue;case'4':_0x177b87=Buffer['concat']([_0x177b87,_0x174f26,_0x58626b]);continue;case'5':_0x177b87=Buffer[_0x6d286a(0x232)](0x7);continue;case'6':_0x177b87['write']('ED',0x0,_0x6d286a(0x1fb));continue;}break;}}else _0x177b87=Buffer['from'](_0x58626b);const _0x290355=_0x39b8cf?0x0:_0x177b87[_0x6d286a(0x225)],_0x2e228f=Buffer[_0x6d286a(0x232)](_0x290355+0x3+_0x152dfb[_0x6d286a(0x21e)]);return!_0x39b8cf&&(_0x2e228f[_0x6d286a(0x22a)](_0x177b87),_0x39b8cf=!![]),_0x2e228f[_0x6d286a(0x237)](_0x53aaee['CsQLb'](_0x152dfb[_0x6d286a(0x21e)],0x10),_0x290355),_0x2e228f['writeUInt16BE'](_0x53aaee[_0x6d286a(0x1f8)](0xffff,_0x152dfb[_0x6d286a(0x21e)]),_0x290355+0x1),_0x2e228f[_0x6d286a(0x22a)](_0x152dfb,_0x53aaee['DONEW'](_0x290355,0x3)),_0x2e228f;},'decodeFrame':async(_0x48fd71,_0x4bf93a)=>{const _0x3c39ff=_0x8e27b;var _0x4eecb6;const _0x418c46=()=>{const _0xf95cca=a1221_0x612f;if(_0x53aaee[_0xf95cca(0x217)](_0x12bf85[_0xf95cca(0x225)],0x3))return _0x53aaee[_0xf95cca(0x20e)](_0x53aaee['MqtEy'](_0x12bf85[_0xf95cca(0x1fe)](),0x10),_0x12bf85[_0xf95cca(0x1f7)](0x1));};_0x12bf85=Buffer['concat']([_0x12bf85,_0x48fd71]),_0x5ee642['trace'](_0x3c39ff(0x200)+_0x48fd71[_0x3c39ff(0x225)]+'\x20bytes,\x20total\x20recv\x20'+_0x12bf85[_0x3c39ff(0x225)]+'\x20bytes');let _0x2b40c5=_0x53aaee[_0x3c39ff(0x220)](_0x418c46);while(_0x2b40c5&&_0x53aaee['cVhMI'](_0x12bf85[_0x3c39ff(0x225)],_0x53aaee['DONEW'](_0x2b40c5,0x3))){let _0x3bd229=_0x12bf85[_0x3c39ff(0x21f)](0x3,_0x53aaee[_0x3c39ff(0x1f9)](_0x2b40c5,0x3));_0x12bf85=_0x12bf85['slice'](_0x53aaee[_0x3c39ff(0x1f9)](_0x2b40c5,0x3));if(_0x5b4283){const _0x35f1bc=_0x507a3f(_0x3bd229);_0x3bd229=await(0x0,WABinary_1[_0x3c39ff(0x22f)])(_0x35f1bc);}_0x5ee642[_0x3c39ff(0x1fc)]({'msg':(_0x4eecb6=_0x3bd229===null||_0x3bd229===void 0x0?void 0x0:_0x3bd229[_0x3c39ff(0x1ff)])===null||_0x53aaee[_0x3c39ff(0x20b)](_0x4eecb6,void 0x0)?void 0x0:_0x4eecb6['id']},_0x53aaee['thtdP']),_0x4bf93a(_0x3bd229),_0x2b40c5=_0x53aaee['pGOvz'](_0x418c46);}}};};exports[a1221_0x1ed2c8(0x1f4)]=makeNoiseHandler;